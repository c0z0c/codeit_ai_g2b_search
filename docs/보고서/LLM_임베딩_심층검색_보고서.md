---
layout: default
title: "[중급프로젝트] - 다단계 검색 및 심층 분석 테스트 보고서"
description: "[중급프로젝트] - 다단계 검색 및 심층 분석 테스트 보고서"
date: 2025-11-19
cache-control: no-cache
expires: 0
pragma: no-cache
author: "김명환"
---

## 다단계 검색 및 심층 분석 테스트 보고서

본 보고서는 LLM RAG 환경에서 **다단계 검색 (Multi-step Retrieval)** 또는 **하이브리드 검색 (Hybrid Retrieval)** 기법의 유효성을 검증하기 위해 수행된 테스트 결과를 요약합니다. 테스트는 1차 검색을 통해 관련성 높은 문서를 식별하고, 해당 문서의 메타데이터(파일 해시)를 필터로 사용하여 2차 심층 검색을 수행하는 방식으로 진행되었습니다.

-----

### 1\. 테스트 목표 및 전략

  * **목표**: 1차 검색으로 식별된 **특정 파일 내**에서만 2차 검색을 수행하여, 검색의 \*\*정밀도(Precision)\*\*를 극대화하고 **심층적인 후속 질의**에 대한 답변 품질을 확보하는 다단계 검색의 작동 유효성을 검증합니다.
  * **전략**:
      * **Step 1 (광범위 검색)**: 일반적인 질의로 전체 문서 집합에서 최적의 페이지와 파일(메타데이터)을 식별합니다.
      * **Step 2 (심층 검색 - 실패 사례)**: 1차 검색 파일 내에서 **관련 없는** 2차 질의를 수행하여 필터링의 효과를 확인합니다 (검색 결과 '0'개 예상).
      * **Step 3 (심층 검색 - 성공 사례)**: 1차 검색 파일 내에서 **관련 있는** 2차 질의를 수행하여 심층 검색의 성공 및 답변 생성 능력을 확인합니다.

-----

### 2\. 테스트 결과 상세

#### 2.1. Step 1: 1차 광범위 검색 및 문서 식별

| 구분 | 내용 |
| :--- | :--- |
| **질의 (Query)** | "중이온 가속기 극저온시스템 스팩은?" |
| **최적 문서 (Best Page)** | `기초과학연구원_2025년도 중이온가속기용 극저온시스템 운전 용역.pdf` (p8) |
| **파일 해시 (Metadata)** | `56e5a8ae813dbddfe5d46b5e5b6c0ea55ba121950217d0ef0aa8a0821f80bcce` |
| **최고 점수 (Score)** | $0.8713$ (페이지 8) |
| **핵심 결과** | 극저온 시스템에 대한 문서를 정확히 식별했으며, 해당 **파일 해시**를 2차 검색을 위한 필터링 메타데이터로 추출함. |

#### 2.2. Step 2: 2차 심층 검색 - 실패 (필터링 유효성 검증)

| 구분 | 내용 |
| :--- | :--- |
| **2차 질의** | "예술경영지원센터 통합 정보시스템 구축 요건은" |
| **필터 (Filter)** | `file_hash`: `56e5a8ae...bcce` (극저온 시스템 문서) |
| **검색 결과** | **FAISS 검색 완료: 0개 결과** (청크 반환: 0개) |
| **핵심 결과** | 1차 검색 파일(`극저온시스템`)의 메타데이터 필터를 사용했을 때, 파일 내용과 **완전히 무관한** 2차 질의(`예술경영`)에 대해 **검색 결과가 0개**로 나옴. 이는 다단계 검색에서 **메타데이터 필터링이 불필요한 노이즈를 효과적으로 제거**하고 검색 범위를 좁히는 데 유효함을 입증함. |

#### 2.3. Step 3: 2차 심층 검색 - 성공 (심층 분석 능력 검증)

| 구분 | 내용 |
| :--- | :--- |
| **2차 질의** | "헬륨회수시스템 이 사용되는 곳은?" |
| **필터 (Filter)** | `file_hash`: `56e5a8ae...bcce` (극저온 시스템 문서) |
| **검색 결과** | **FAISS 검색 완료: 2개 결과** (청크 반환: 2개) |
| **최적 문서** | `기초과학연구원_2025년도 중이온가속기용 극저온시스템 운전 용역.pdf` (p8) |
| **LLM 답변** | "문서(페이지 8)에 따르면 헬륨 회수시스템 관련 장비들의 사용 위치는 다음과 같습니다. \<ul\>\<li\>회수 압축시스템: 헬륨압축기동\</li\>\<li\>가스백: 헬륨압축기동\</li\>\<li\>외부 정화기: 외부 ...\</li\>\</ul\>" |
| **핵심 결과** | 1차 검색 파일 내에서 **깊이 있는 후속 질의**(`헬륨회수시스템`)에 대해 **성공적으로 관련 청크를 검색**하고, LLM이 해당 청크를 기반으로 상세하고 정확한 **위치 정보**를 포함한 답변을 생성함. 이는 다단계 검색이 **심층 분석**에 효과적임을 입증함. |

-----

### 3\. 결론 및 제언

테스트 결과, **메타데이터 필터링을 활용한 다단계 검색 (Multi-step Retrieval)** 방식은 RAG 시스템의 **검색 정밀도와 효율성**을 크게 향상시키는 것으로 확인되었습니다.

  * **정밀도 향상**: 1차 검색으로 식별된 **특정 파일에 대한 필터링**을 통해 불필요한 문서 검색을 차단하고, 2차 질의의 컨텍스트를 해당 파일로만 한정하여 **심층적인 정보**를 정확하게 추출할 수 있었습니다.
  * **유효성 입증**: 무관한 질의(Step 2)에서는 검색 실패로 필터링 효과를, 관련 질의(Step 3)에서는 명확한 답변 생성으로 심층 분석 능력을 입증하였습니다.

**제언**: 향후 RAG 시스템 개발 시, 사용자의 심층적인 Follow-up 질문에 대비하여 **파일 해시, 작성일자, 문서 유형** 등의 **메타데이터를 활용한 다단계 필터링 로직**을 표준 상호작용 프로토콜로 채택할 것을 제언합니다.