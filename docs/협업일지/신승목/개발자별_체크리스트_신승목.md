---
layout: default
title: "[중급프로젝트] - 신승목: 문서 수집 및 원본 전처리"
description: "[중급프로젝트] - 신승목: 문서 수집 및 원본 전처리"
date: 2025-11-26
cache-control: no-cache
expires: 0
pragma: no-cache
author: "신승목"
---

## 👤 신승목: 문서 수집 및 원본 전처리

### Phase 1: 환경 설정
- [V] PDF 처리 라이브러리 설치 (PyPDF2, pdfplumber 등)
- [V] HWP 처리 라이브러리 설치 (olefile, hwp5 등)
- [V] Markdown 변환 도구 선정
- [V] 해시 계산 유틸리티 함수 작성 (SHA-256)

### Phase 2: 문서 수집 모듈
- [V] 로컬 파일 시스템에서 PDF/HWP 파일 수집 함수
- [V] 데이터 포털 API 연동 (선택 사항)
- [V] 파일 중복 확인 로직 (file_hash 기준)
- [V] 파일 메타데이터 추출 (크기, 페이지 수 등)

### Phase 3: Markdown 변환
- [V] PDF → Markdown 변환 함수
  - [V] 페이지 구분자 삽입: `\n\n--- 페이지 {page_num} ---\n\n`
  - [V] 빈 페이지 처리: `\n--- [빈페이지] ---\n`
  - [V] 이미지/표 처리 전략 결정
- [V] HWP → Markdown 변환 함수
- [V] 기본 전처리 함수
  - [V] 연속된 개행 정리 (`\n\n\n` → `\n\n`)

### Phase 4: DB 저장 (토큰 저장 항목 제거)
- [V] `file_info` 테이블 삽입 함수
- [V] `page_data` 테이블 삽입 함수
- [V] 트랜잭션 처리 및 에러 핸들링

### Phase 5: 통합 및 테스트
- [V] 더미 함수에서 실제 구현으로 전환
- [V] 3개 샘플 문서로 전체 파이프라인 테스트
- [V] 증분 업데이트 로직 구현 (file_hash 비교)
- [V] 로깅 시스템 추가
- [V] 오형주에게 UI 연동 API 전달

### 주요 함수 인터페이스
```python
def calculate_file_hash(file_path: str) -> str:
    """파일 SHA-256 해시 계산"""

def process_doc(self, doc_path: str, doc_name: Optional[str] = None) -> Tuple[Optional[str], bool]:
        """
        [메인 문서 처리 함수]
        HWP, PDF 파일을 분기 처리하여 Markdown으로 변환하고 DB에 저장합니다.
        HWP 처리는 자체 개발한 hwp_helper 라이브러리 사용
        PDF 처리는 pymupdf4llm 라이브러리 사용
        DB 저장은 SQLite 사용
        """

def process_date(self, data_key: str, start_date: str, end_date: str) -> Tuple[Optional[str], bool]:
        """
        [외부 UI 실행 함수]
        1. data_key(인증키) 검증
        2. 날짜별 공고 조회 (API 호출)
        3. 첨부파일 URL 추출 및 다운로드
        4. 파일 확장자별 마크다운 및 DB 저장(process_doc 사용)
        5. DB 저장 후 임시 파일 제거
        """
```
